{% extends 'CCDNUserProfileBundle::base.html.twig' %}

{% set LayoutTemplate = ccdn_user_profile.profile.show.overview.layout_template %}

{% block title %}{{- truncDot('title.profile.show' | trans({ '%name%': profile.getUsername}, 'CCDNUserProfileBundle'), ccdn_user_profile.seo.title_length) -}}{% endblock %}

{% block sub_title %}
	{{- profile.getProfilePath() |raw -}}
{% endblock %}


{% block body_content %}

	{%- spaceless -%}

	{%- include 'CCDNUserProfileBundle:Profile:item_header.html.twig' -%}

	{%- include 'CCDNUserProfileBundle:Profile:item_tabs.html.twig' -%}
	
	<header class="row-fluid">
		<div class="span9">
			<h3>{{- 'generic.profile.personal' |trans({}, 'CCDNUserProfileBundle') -}}</h3>
		</div>
		{%- if is_granted('ROLE_USER') -%}
			{%- if profile.getUser is not null -%}
				{%- if profile.getUser.id == app.user.id or is_granted('ROLE_ADMIN') -%}
					<div class="span3 btn-right">
						<a class="btn" href="{{- path('ccdn_user_profile_edit_personal', {'profileId':profile.id}) -}}">{{- 'form.button.update' |trans({}, 'CCDNUserProfileBundle') -}}</a>
					</div>
				{%- endif -%}
			{%- endif -%}
		{%- endif -%}
	</header>

	<section>
		<table class="table table-striped table-bordered table-vertical-labels table-hover">
			<tbody>
				<tr>
					<td class="right">{{- 'generic.thead.username'|trans({}, 'CCDNUserProfileBundle') -}}</td>
					<td class="left">{{- profile.getUsernameBDI |raw -}}</td>
				</tr>

				{%- if profile.getUser is not null -%}
					{%- if profile.getUser.getRegisteredDate is not null -%}
						<tr>
							<td class="right">{{- 'generic.thead.member_since'|trans({}, 'CCDNUserProfileBundle') -}}</td>
							<td class="left">
								<abbr class="timestamper" title="{{- profile.getUser.getRegisteredDate |date('Y-m-d H:i:s T Z', 'Europe/London') -}}">
									{{- profile.getUser.getRegisteredDate |date(ccdn_user_profile.profile.show.overview.last_login_datetime_format) -}}
								</abbr>
							</td>
						</tr>
					{%- endif -%}

					{%- if profile.getUser.getLastLogin is not null -%}
						<tr>
							<td class="right">{{- 'generic.thead.last_logged_in'|trans({}, 'CCDNUserProfileBundle') -}}</td>
							<td class="left">
								<abbr class="timestamper" title="{{- profile.getUser.getLastLogin |date('Y-m-d H:i:s T Z', 'Europe/London') -}}">
									{{- profile.getUser.getLastLogin |date(ccdn_user_profile.profile.show.overview.member_since_datetime_format) -}}
								</abbr>
							</td>
						</tr>
					{%- endif -%}
				{%- endif -%}

				{%- if profile.getLocation is not null -%}
					<tr>
						<td class="right">{{- 'generic.thead.location'|trans({}, 'CCDNUserProfileBundle') -}}</td>
						<td class="left"><bdi>{{- profile.getLocation -}}</bdi></td>
					</tr>
				{%- endif -%}

				{%- if profile.getWebsite is not null -%}
					<tr>
						<td class="right">{{- 'generic.thead.website'|trans({}, 'CCDNUserProfileBundle') -}}</td>
						<td class="left"><a href="{{- profile.getWebsite -}}" target="_blank">{{- profile.getWebsite -}}</a></td>
					</tr>
				{%- endif -%}
			</tbody>
		</table>
	</section>

	<header class="row-fluid">
		<div class="span9">
			<h3>{{- 'generic.profile.contact.heading' |trans({}, 'CCDNUserProfileBundle') -}}</h3>
		</div>
		{%- if is_granted('ROLE_USER') -%}
			{%- if user.id == app.user.id or is_granted('ROLE_ADMIN') -%}
				<div class="span3 btn-right">
					<a class="btn" href="{{- path('ccdn_user_profile_edit_contact', {'profileId':profile.id}) -}}">{{- 'form.button.update' |trans({}, 'CCDNUserProfileBundle') -}}</a>
				</div>
			{%- endif -%}
		{%- endif -%}
	</header>

	<section>
		{%- if (profile.getAimIsPublic is not null and profile.getAim is not null) or (profile.getAim is not null and is_granted('ROLE_ADMIN'))
			or (profile.getMsnIsPublic is not null and profile.getMsn is not null) or (profile.getMsn is not null and is_granted('ROLE_ADMIN'))
			or (profile.getIcqIsPublic is not null and profile.getIcq is not null) or (profile.getIcq is not null and is_granted('ROLE_ADMIN'))
			or (profile.getYahooIsPublic is not null and profile.getYahoo is not null) or (profile.getYahoo is not null and is_granted('ROLE_ADMIN'))
		-%}
			<table class="table table-striped table-bordered table-vertical-labels">
				<tbody>
					{%- if is_granted('ROLE_USER') -%}
						{%- if profile.getAimIsPublic is not null and profile.getAim is not null -%}
							<tr>
								<td class="right">{{- 'generic.thead.aim'|trans({}, 'CCDNUserProfileBundle') -}}</td>
								<td class="left">{{- profile.getAim -}}</td>
							</tr>
						{%- endif -%}

						{%- if profile.getMsnIsPublic is not null and profile.getMsn is not null -%}
							<tr>
								<td class="right">{{- 'generic.thead.msn'|trans({}, 'CCDNUserProfileBundle') -}}</td>
								<td class="left">{{- profile.getMsn -}}</td>
							</tr>
						{%- endif -%}

						{%- if profile.getIcqIsPublic is not null and profile.getIcq is not null -%}
							<tr>
								<td class="right">{{- 'generic.thead.icq'|trans({}, 'CCDNUserProfileBundle') -}}</td>
								<td class="left">{{- profile.getIcq -}}</td>
							</tr>
						{%- endif -%}

						{%- if profile.getYahooIsPublic is not null and profile.getYahoo is not null -%}
							<tr>
								<td class="right">{{- 'generic.thead.yahoo'|trans({}, 'CCDNUserProfileBundle') -}}</td>
								<td class="left">{{- profile.getYahoo -}}</td>
							</tr>
						{%- endif -%}
					{%- endif -%}
				</tbody>
			</table>
		{%- else -%}
			{%- if is_granted('ROLE_USER') -%}
				{%- if profile.getUser is not null -%}
					{%- if profile.getUser.id == app.user.id -%}
						<div class="alert alert-warning">
							{{- 'generic.profile.contact.none_owner' | trans({}, 'CCDNUserProfileBundle') -}}
						</div>
					{%- else -%}
						<div class="lead center">
							<br>
							<h5>{{- 'generic.profile.contact.none' | trans({}, 'CCDNUserProfileBundle') -}}</h5>
						</div>
					{%- endif -%}
				{%- else -%}
					<div class="lead center">
						<br>
						<h5>{{- 'generic.profile.contact.none' | trans({}, 'CCDNUserProfileBundle') -}}</h5>
					</div>
				{%- endif -%}
			{%- else -%}
				<div class="lead center">
					<br>
					<h5>{{- 'generic.profile.contact.none' | trans({}, 'CCDNUserProfileBundle') -}}</h5>
				</div>
			{%- endif -%}
		{%- endif -%}
	</section>

	<br>

	{%- endspaceless -%}

{% endblock body_content %}
